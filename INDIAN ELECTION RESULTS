----total seats -----
select COUNT(DISTINCT(Constituency_ID) ) as total_seats 
from constituencywise_details 

-----what si totla numeber of seats available in each state ----
select states.State as state_name , COUNT(DISTINCT(Constituency_ID)) from constituencywise_results
join statewise_results on constituencywise_results.Parliament_Constituency=statewise_results.Parliament_Constituency
join states on statewise_results.State_ID=states.State_ID
group by states.State
order by 2 desc

-----total seats won by NDA alliance -----
select sum(case
when Party IN('Bharatiya Janata Party - BJP', 
                'Telugu Desam - TDP', 
				'Janata Dal  (United) - JD(U)',
                'Shiv Sena - SHS', 
                'AJSU Party - AJSUP', 
                'Apna Dal (Soneylal) - ADAL', 
                'Asom Gana Parishad - AGP',
                'Hindustani Awam Morcha (Secular) - HAMS', 
                'Janasena Party - JnP', 
				'Janata Dal  (Secular) - JD(S)',
                'Lok Janshakti Party(Ram Vilas) - LJPRV', 
                'Nationalist Congress Party - NCP',
                'Rashtriya Lok Dal - RLD', 
                'Sikkim Krantikari Morcha - SKM'
				) then[won]
				else 0
				end
				) as_nda_total_sseats_won
				FROM
				partywise_results

-----SEATS WON BY NDA ALLIANCE PARTIES ----
select Party as party_name,
Won as seats_won
from partywise_results
where Party IN('Bharatiya Janata Party - BJP', 
                'Telugu Desam - TDP', 
				'Janata Dal  (United) - JD(U)',
                'Shiv Sena - SHS', 
                'AJSU Party - AJSUP', 
                'Apna Dal (Soneylal) - ADAL', 
                'Asom Gana Parishad - AGP',
                'Hindustani Awam Morcha (Secular) - HAMS', 
                'Janasena Party - JnP', 
				'Janata Dal  (Secular) - JD(S)',
                'Lok Janshakti Party(Ram Vilas) - LJPRV', 
                'Nationalist Congress Party - NCP',
                'Rashtriya Lok Dal - RLD', 
                'Sikkim Krantikari Morcha - SKM')
				order by 2 desc

-------SEATS WON BY INDIA ALLIANCE----
select sum(case
when Party IN('Indian National Congress - INC',
                'Aam Aadmi Party - AAAP',
                'All India Trinamool Congress - AITC',
                'Bharat Adivasi Party - BHRTADVSIP',
                'Communist Party of India  (Marxist) - CPI(M)',
                'Communist Party of India  (Marxist-Leninist)  (Liberation) - CPI(ML)(L)',
                'Communist Party of India - CPI',
                'Dravida Munnetra Kazhagam - DMK',
                'Indian Union Muslim League - IUML',
                'Nat`Jammu & Kashmir National Conference - JKN',
                'Jharkhand Mukti Morcha - JMM',
                'Jammu & Kashmir National Conference - JKN',
                'Kerala Congress - KEC',
                'Marumalarchi Dravida Munnetra Kazhagam - MDMK',
                'Nationalist Congress Party Sharadchandra Pawar - NCPSP',
                'Rashtriya Janata Dal - RJD',
                'Rashtriya Loktantrik Party - RLTP',
                'Revolutionary Socialist Party - RSP',
                'Samajwadi Party - SP',
                'Shiv Sena (Uddhav Balasaheb Thackrey) - SHSUBT',
                'Viduthalai Chiruthaigal Katchi - VCK')
				then[Won]
				else 0
				end) as india_total_seats_won
				from partywise_results

----- seats won by india alliance party individually-----
select Party as party_name,Won as seats_won
from partywise_results
where Party IN('Indian National Congress - INC',
                'Aam Aadmi Party - AAAP',
                'All India Trinamool Congress - AITC',
                'Bharat Adivasi Party - BHRTADVSIP',
                'Communist Party of India  (Marxist) - CPI(M)',
                'Communist Party of India  (Marxist-Leninist)  (Liberation) - CPI(ML)(L)',
                'Communist Party of India - CPI',
                'Dravida Munnetra Kazhagam - DMK',
                'Indian Union Muslim League - IUML',
                'Nat`Jammu & Kashmir National Conference - JKN',
                'Jharkhand Mukti Morcha - JMM',
                'Jammu & Kashmir National Conference - JKN',
                'Kerala Congress - KEC',
                'Marumalarchi Dravida Munnetra Kazhagam - MDMK',
                'Nationalist Congress Party Sharadchandra Pawar - NCPSP',
                'Rashtriya Janata Dal - RJD',
                'Rashtriya Loktantrik Party - RLTP',
                'Revolutionary Socialist Party - RSP',
                'Samajwadi Party - SP',
                'Shiv Sena (Uddhav Balasaheb Thackrey) - SHSUBT',
                'Viduthalai Chiruthaigal Katchi - VCK'
				)
				order by 2 desc

------add a new column field to table partywise_results to metion whether the party lies in nda aaliance or india aaliance -----

ALTER TABLE partywise_results
ADD party_alliance varchar(50);


update partywise_results
set party_alliance= 'INDIA'
WHERE Party IN('Indian National Congress - INC',
                'Aam Aadmi Party - AAAP',
                'All India Trinamool Congress - AITC',
                'Bharat Adivasi Party - BHRTADVSIP',
                'Communist Party of India  (Marxist) - CPI(M)',
                'Communist Party of India  (Marxist-Leninist)  (Liberation) - CPI(ML)(L)',
                'Communist Party of India - CPI',
                'Dravida Munnetra Kazhagam - DMK',
                'Indian Union Muslim League - IUML',
                'Nat`Jammu & Kashmir National Conference - JKN',
                'Jharkhand Mukti Morcha - JMM',
                'Jammu & Kashmir National Conference - JKN',
                'Kerala Congress - KEC',
                'Marumalarchi Dravida Munnetra Kazhagam - MDMK',
                'Nationalist Congress Party Sharadchandra Pawar - NCPSP',
                'Rashtriya Janata Dal - RJD',
                'Rashtriya Loktantrik Party - RLTP',
                'Revolutionary Socialist Party - RSP',
                'Samajwadi Party - SP',
                'Shiv Sena (Uddhav Balasaheb Thackrey) - SHSUBT',
                'Viduthalai Chiruthaigal Katchi - VCK'
				);
------ nda alliance -----

update partywise_results
set party_alliance= 'NDA'
WHERE Party IN('Bharatiya Janata Party - BJP', 
                'Telugu Desam - TDP', 
				'Janata Dal  (United) - JD(U)',
                'Shiv Sena - SHS', 
                'AJSU Party - AJSUP', 
                'Apna Dal (Soneylal) - ADAL', 
                'Asom Gana Parishad - AGP',
                'Hindustani Awam Morcha (Secular) - HAMS', 
                'Janasena Party - JnP', 
				'Janata Dal  (Secular) - JD(S)',
                'Lok Janshakti Party(Ram Vilas) - LJPRV', 
                'Nationalist Congress Party - NCP',
                'Rashtriya Lok Dal - RLD', 
                'Sikkim Krantikari Morcha - SKM'
				);

------ OTHERS---

update partywise_results
set party_alliance= 'OTHER'
WHERE party_alliance is null;


-----Which party alliance (NDA, I.N.D.I.A, or OTHER) won the most seats across all states?----
select partywise_results.party_alliance,
count(constituencywise_results.Constituency_ID) as seats_won
from constituencywise_results
join partywise_results ON partywise_results.Party_ID=constituencywise_results.Party_ID
where partywise_results.party_alliance IN('INDIA','NDA','OTHER')
GROUP BY partywise_results.party_alliance
order by seats_won desc

---Winning candidate's name, their party name, total votes, and the margin of victory for a specific state and constituency?---
select constituencywise_results.Winning_Candidate,constituencywise_results.Total_Votes,constituencywise_results.Margin,partywise_results.Party,
statewise_results.State,constituencywise_results.Constituency_Name
from constituencywise_results 
join partywise_results on partywise_results.Party_ID=constituencywise_results.Party_ID
join statewise_results on statewise_results.Parliament_Constituency=constituencywise_results.Parliament_Constituency
join states on states.State_ID=statewise_results.State_ID
where states.State ='UTTAR PRADESH' AND constituencywise_results.Constituency_Name='VARANASI'

------What is the distribution of EVM votes versus postal votes for candidates in a specific constituency----
select constituencywise_details.EVM_Votes,constituencywise_details.Postal_Votes,constituencywise_details.Total_Votes,constituencywise_details.Candidate,constituencywise_results.Constituency_Name
from constituencywise_details
join constituencywise_results on constituencywise_results.Constituency_ID=constituencywise_details.Constituency_ID
where Constituency_Name='VARANASI'
ORDER BY constituencywise_details.Total_Votes desc

--------Which parties won the most seats in s State, and how many seats did each party win?----
select partywise_results.Party,count(constituency_ID) as seats_won
FROM constituencywise_results
join partywise_results on partywise_results.Party_ID=constituencywise_results.Party_ID
join statewise_results on statewise_results.Parliament_Constituency=constituencywise_results.Parliament_Constituency
join states on states.State_ID=statewise_results.State_ID
where states.State='Assam'
group by partywise_results.Party
order by 2 desc

---What is the total number of seats won by each party alliance (NDA, I.N.D.I.A, and OTHER) in each state for the India Elections 2024---
select states.State,
SUM(case when partywise_results.party_alliance='NDA' then 1 else 0 end ) as nda_seats_won,
SUM(case when partywise_results.party_alliance='INDIA' then 1 else 0 end ) as india_seats_won,
SUM(case when partywise_results.party_alliance='OTHER' then 1 else 0 end ) as others_seats_won
from constituencywise_results
join partywise_results on partywise_results.Party_ID=constituencywise_results.Party_ID
join statewise_results on statewise_results.Parliament_Constituency=constituencywise_results.Parliament_Constituency
join states on states.State_ID=statewise_results.State_ID
where partywise_results.party_alliance IN('NDA','INDIA','OTHER')
GROUP BY states.State
order by states.State desc

----Which candidate received the highest number of EVM votes in each constituency (Top 10)?----

select top 10 
constituencywise_results.Constituency_Name,Candidate,constituencywise_details.Party,constituencywise_details.EVM_Votes,
constituencywise_details.Total_Votes from constituencywise_details
JOIN constituencywise_results ON constituencywise_results.Constituency_ID=constituencywise_details.Constituency_ID
where constituencywise_details.EVM_Votes= (select max(cd1.EVM_Votes)
from constituencywise_details as cd1
WHERE cd1.Constituency_ID = constituencywise_details.Constituency_ID)
ORDER BY constituencywise_details.EVM_Votes 

---Which candidate won and which candidate was the runner-up in each constituency of State for the 2024 elections?---

WITH RankedCandidates AS (
    SELECT 
        cd.Constituency_ID,
        cd.Candidate,
        cd.Party,
        cd.EVM_Votes,
        cd.Postal_Votes,
        cd.EVM_Votes + cd.Postal_Votes AS Total_Votes,
        ROW_NUMBER() OVER (PARTITION BY cd.Constituency_ID ORDER BY cd.EVM_Votes + cd.Postal_Votes DESC) AS VoteRank
    FROM 
        constituencywise_details cd
    JOIN 
        constituencywise_results cr ON cd.Constituency_ID = cr.Constituency_ID
    JOIN 
        statewise_results sr ON cr.Parliament_Constituency = sr.Parliament_Constituency
    JOIN 
        states s ON sr.State_ID = s.State_ID
    WHERE 
        s.State = 'Maharashtra'
)

SELECT 
    cr.Constituency_Name,
    MAX(CASE WHEN rc.VoteRank = 1 THEN rc.Candidate END) AS Winning_Candidate,
    MAX(CASE WHEN rc.VoteRank = 2 THEN rc.Candidate END) AS Runnerup_Candidate
FROM 
    RankedCandidates rc
JOIN 
    constituencywise_results cr ON rc.Constituency_ID = cr.Constituency_ID
GROUP BY 
    cr.Constituency_Name
ORDER BY 
    cr.Constituency_Name;




